<!DOCTYPE html>
<html lang="en">
  <%- include('./../components/header') %>
  <body class="bg-gray-100 font-sans antialiased">
    <%- include('./../components/navbar') %>

    <div class="container mx-auto p-8">
      <div class="text-center mb-6">
        <h1 class="text-3xl font-bold text-gray-800">
          Upload Images to Convert to PDF
        </h1>
        <p class="mt-2 text-gray-600">
          Drag and drop your images, or click to select them.
        </p>
      </div>

      <div class="flex justify-center items-center space-x-4">
        <!-- Drag-and-drop or browse images -->
        <div id="drop-area" class="drop-area">
          <p class="text-gray-500">Drag & Drop your images here</p>
          <p class="text-gray-400 text-sm">Or</p>
          <input
            type="file"
            id="file-input"
            accept="image/*"
            multiple
            class="hidden"
          />
          <label
            for="file-input"
            class="cursor-pointer bg-green-500 text-white py-2 px-4 rounded-lg mt-2"
            >Browse Files</label
          >
        </div>
      </div>

      <div class="mt-6 text-center">
        <button
          id="upload-btn"
          class="bg-blue-500 text-white py-2 px-6 rounded-lg"
        >
          Convert to PDF
        </button>
      </div>
    </div>

    <script>
      const dropArea = document.getElementById("drop-area");
      const fileInput = document.getElementById("file-input");
      const uploadBtn = document.getElementById("upload-btn");
      let files = [];

      // Handle drag-and-drop events
      dropArea.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropArea.classList.add("dragover");
      });

      dropArea.addEventListener("dragleave", () => {
        dropArea.classList.remove("dragover");
      });

      dropArea.addEventListener("drop", (e) => {
        e.preventDefault();
        dropArea.classList.remove("dragover");
        files = e.dataTransfer.files;
      });

      // Handle file input selection
      fileInput.addEventListener("change", (e) => {
        files = e.target.files;
      });

      // Handle file upload on button click
      uploadBtn.addEventListener("click", async () => {
        if (files.length === 0) {
          alert("Please select or drag-drop some images.");
          return;
        }

        const formData = new FormData();
        for (let i = 0; i < files.length; i++) {
          formData.append("images", files[i]);
        }

        try {
          const response = await axios.post("/api/image-to-pdf", formData, {
            headers: {
              "Content-Type": "multipart/form-data",
            },
          });
          alert("PDF Created Successfully!");
          // Optionally, handle the response (e.g., provide a download link)
          console.log(response.data);
        } catch (error) {
          console.error(error);
          alert("Error creating PDF.");
        }
      });
    </script>
    <%- include('./../components/footer') %>
  </body>
</html>
